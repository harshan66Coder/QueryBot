<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>QueryBot</title>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-dH1yXpkATvNnK65D8JjVHxRv6BE8kYiZvZZyKySf+DqcmDhNSJJzBfkU19IkwkTw"
      crossorigin="anonymous"
    ></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.5.0/sql-wasm.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="index.css" />
  </head>

  <body>
    <div id="togglebutton" class="theme-toggle">
      <img
        id="themeImage"
        src="/QueryBot/assets/dark.png"
        alt="Theme Image"
        width="20"
      />
    </div>
    <div class="section">
      <h2>1. Upload File (CSV or SQLite)</h2>

      <label for="input"
        >Upload CSV <span class="text-danger">(.csv)</span> or SQLite database
        <span class="text-danger">(.sqlite , .db)</span>
      </label>
      <input type="file" id="fileInput" class="input-filed mt-2" /><br /><br />

      <p id="errmessage"></p>

      <div id="generatedField" style="display: none">
        <label
          >Generated Example Question
          <span
            id="exampleLoader"
            class="spinner-border spinner-border-sm"
            style="display: none"
          ></span
        ></label>
        <textarea id="exampleQ"></textarea>
      </div>

      <div class="section" id="tableInspectorSection" style="display: none">
        <h2>Table Inspector</h2>
        <label for="tableList" class="select-table">Select Table:</label>
        <select id="tableList" class="form-select"></select>

        <div style="margin-top: 16px">
          <div>
            <b>CREATE TABLE SQL:</b>
            <pre id="tableCreateSQL" class="code-block"></pre>
          </div>
          <div style="margin-top: 22px">
            <b>Columns &amp; Types</b>
            <table id="tableColsInfo"></table>
          </div>
        </div>
      </div>
    </div>

    <div class="section" id="QuestionArea" style="display: none">
      <h2 class="mt-3">
        2. Ask a question and provide context about your dataset
      </h2>
      <textarea
        id="question"
        placeholder="Ask something like 'Show all cars with mileage above 20'"
      ></textarea>
      <button class="btn btn-primary" id="askBtn">
        <span id="btnText">Get Table</span>
        <span
          id="btnLoader"
          class="spinner-border spinner-border-sm"
          style="display: none"
        ></span>
      </button>
    </div>

    <div id="autoScroll-output">
      <div class="section" id="generatedOutput" style="display: none">
        <h2 class="mt-3">Generated Output</h2>
        <div id="generatedSQL"></div>
      </div>
    </div>

    <div class="section" id="res" style="display: none">
      <h2 class="mt-2">Output</h2>

      <div
        class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-3"
      >
        <button class="btn btn-primary mb-3" id="downloadBtn">
          Download Table CSV
        </button>

        <textarea
          id="chartQuestion"
          class="form-control"
          style="flex: 1; height: 30px; width: 700px"
          placeholder="Ask something like 'Show average price by brand'"
        ></textarea>

        <div class="d-flex gap-2">
          <button class="btn btn-primary mb-3" id="chartQueryBtn">
            <span id="chartQueryBtnText">Generate Bar Chart</span>
            <span
              id="chartLoader"
              class="spinner-border spinner-border-sm"
              style="display: none"
            ></span>
          </button>
          <button class="btn btn-primary mb-3" id="downloadChartJs">
            Download Chart JS Code
          </button>
        </div>
      </div>
      <div id="result"></div>
      <div id="chartCode"></div>
    </div>
    <script src="script.js"></script>
  </body>
</html>
